import 'package:kali_on_debian/services/select_tools_to_install.dart';

/// Provides a predefined list of Kali vulnerability-related tools and a selector to install them interactively.
///
/// The enum `KaliToolsVulnerabilityEnum` defines supported packages
enum KaliToolsVulnerabilityEnum {
  aflpp,
  bed,
  ciscoAuditingTool,
  ciscoGlobalExploiter,
  ciscoOcs,
  ciscoTorch,
  copyRouterConfig,
  dhcpig,
  enumiax,
  gvm,
  iaxflood,
  inviteflood,
  legion,
  lynis,
  nikto,
  nmap,
  ohrwurm,
  peass,
  protosSip,
  rtpbreak,
  rtpflood,
  rtpinsertsound,
  rtpmixsound,
  sctpscan,
  sfuzz,
  siege,
  siparmyknife,
  sipp,
  sipsak,
  sipvicious,
  slowhttptest,
  spike,
  t50,
  thcSslDos,
  unixPrivescCheck,
  voiphopper,
  yersinia,
}

/// The map `_kaliToolsVulnerabilityMap` associates each enum with its corresponding package name.
Map<KaliToolsVulnerabilityEnum, String> _kaliToolsVulnerabilityMap = {
  KaliToolsVulnerabilityEnum.aflpp: 'afl++',
  KaliToolsVulnerabilityEnum.bed: 'bed',
  KaliToolsVulnerabilityEnum.ciscoAuditingTool: 'cisco-auditing-tool',
  KaliToolsVulnerabilityEnum.ciscoGlobalExploiter: 'cisco-global-exploiter',
  KaliToolsVulnerabilityEnum.ciscoOcs: 'cisco-ocs',
  KaliToolsVulnerabilityEnum.ciscoTorch: 'cisco-torch',
  KaliToolsVulnerabilityEnum.copyRouterConfig: 'copy-router-config',
  KaliToolsVulnerabilityEnum.dhcpig: 'dhcpig',
  KaliToolsVulnerabilityEnum.enumiax: 'enumiax',
  KaliToolsVulnerabilityEnum.gvm: 'gvm',
  KaliToolsVulnerabilityEnum.iaxflood: 'iaxflood',
  KaliToolsVulnerabilityEnum.inviteflood: 'inviteflood',
  KaliToolsVulnerabilityEnum.legion: 'legion',
  KaliToolsVulnerabilityEnum.lynis: 'lynis',
  KaliToolsVulnerabilityEnum.nikto: 'nikto',
  KaliToolsVulnerabilityEnum.nmap: 'nmap',
  KaliToolsVulnerabilityEnum.ohrwurm: 'ohrwurm',
  KaliToolsVulnerabilityEnum.peass: 'peass',
  KaliToolsVulnerabilityEnum.protosSip: 'protos-sip',
  KaliToolsVulnerabilityEnum.rtpbreak: 'rtpbreak',
  KaliToolsVulnerabilityEnum.rtpflood: 'rtpflood',
  KaliToolsVulnerabilityEnum.rtpinsertsound: 'rtpinsertsound',
  KaliToolsVulnerabilityEnum.rtpmixsound: 'rtpmixsound',
  KaliToolsVulnerabilityEnum.sctpscan: 'sctpscan',
  KaliToolsVulnerabilityEnum.sfuzz: 'sfuzz',
  KaliToolsVulnerabilityEnum.siege: 'siege',
  KaliToolsVulnerabilityEnum.siparmyknife: 'siparmyknife',
  KaliToolsVulnerabilityEnum.sipp: 'sipp',
  KaliToolsVulnerabilityEnum.sipsak: 'sipsak',
  KaliToolsVulnerabilityEnum.sipvicious: 'sipvicious',
  KaliToolsVulnerabilityEnum.slowhttptest: 'slowhttptest',
  KaliToolsVulnerabilityEnum.spike: 'spike',
  KaliToolsVulnerabilityEnum.t50: 't50',
  KaliToolsVulnerabilityEnum.thcSslDos: 'thc-ssl-dos',
  KaliToolsVulnerabilityEnum.unixPrivescCheck: 'unix-privesc-check',
  KaliToolsVulnerabilityEnum.voiphopper: 'voiphopper',
  KaliToolsVulnerabilityEnum.yersinia: 'yersinia',
};

/// The extension `KaliToolsVulnerabilityEnumExt` exposes the resolved package name via the package getter.
extension KaliToolsVulnerabilityEnumExt on KaliToolsVulnerabilityEnum {
  String get package {
    switch (this) {
      default:
        return _kaliToolsVulnerabilityMap[this]!;
    }
  }
}

/// Call `selectKaliToolsVulnerabilityToInstall()` to prompt the user to select one or more tools to install from the `kali-tools-vulnerability` group. Uses `selectToolsToInstall()` with enum values and package names.
Future<void> selectKaliToolsVulnerabilityToInstall() =>
    selectToolsToInstall<KaliToolsVulnerabilityEnum>(
      groupName: 'kali-tools-vulnerability',
      values: KaliToolsVulnerabilityEnum.values,
      packageNameGetter: (e) => e.package,
    );
