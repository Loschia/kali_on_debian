import 'package:kali_on_debian/services/select_tools_to_install.dart';

/// Provides a predefined list of Kali post-exploitation-related tools and a selector to install them interactively.
///
/// The enum `KaliToolsPostExploitationEnum` defines supported packages.
enum KaliToolsPostExploitationEnum {
  cymothoa,
  dbd,
  dns2tcp,
  exe2hexbat,
  iodine,
  laudanum,
  mimikatz,
  miredo,
  nishang,
  powersploit,
  proxychains4,
  proxytunnel,
  ptunnel,
  pwnat,
  sbd,
  shellter,
  sslh,
  stunnel4,
  udptunnel,
  veil,
  webacoo,
  weevely,
}

/// The map `_kaliToolsPostExploitationMap` associates each enum with its corresponding package name.
Map<KaliToolsPostExploitationEnum, String> _kaliToolsPostExploitationMap = {
  KaliToolsPostExploitationEnum.cymothoa: 'cymothoa',
  KaliToolsPostExploitationEnum.dbd: 'dbd',
  KaliToolsPostExploitationEnum.dns2tcp: 'dns2tcp',
  KaliToolsPostExploitationEnum.exe2hexbat: 'exe2hexbat',
  KaliToolsPostExploitationEnum.iodine: 'iodine',
  KaliToolsPostExploitationEnum.laudanum: 'laudanum',
  KaliToolsPostExploitationEnum.mimikatz: 'mimikatz',
  KaliToolsPostExploitationEnum.miredo: 'miredo',
  KaliToolsPostExploitationEnum.nishang: 'nishang',
  KaliToolsPostExploitationEnum.powersploit: 'powersploit',
  KaliToolsPostExploitationEnum.proxychains4: 'proxychains4',
  KaliToolsPostExploitationEnum.proxytunnel: 'proxytunnel',
  KaliToolsPostExploitationEnum.ptunnel: 'ptunnel',
  KaliToolsPostExploitationEnum.pwnat: 'pwnat',
  KaliToolsPostExploitationEnum.sbd: 'sbd',
  KaliToolsPostExploitationEnum.shellter: 'shellter',
  KaliToolsPostExploitationEnum.sslh: 'sslh',
  KaliToolsPostExploitationEnum.stunnel4: 'stunnel4',
  KaliToolsPostExploitationEnum.udptunnel: 'udptunnel',
  KaliToolsPostExploitationEnum.veil: 'veil',
  KaliToolsPostExploitationEnum.webacoo: 'webacoo',
  KaliToolsPostExploitationEnum.weevely: 'weevely',
};

/// The extension `KaliToolsPostExploitationEnumExt` exposes the resolved package name via the package getter.
extension KaliToolsPostExploitationEnumExt on KaliToolsPostExploitationEnum {
  String get package {
    switch (this) {
      default:
        return _kaliToolsPostExploitationMap[this]!;
    }
  }
}

/// Call `selectKaliToolsPostExploitationToInstall()` to prompt the user to select one or more tools to install from the `kali-tools-post-exploitation` group. Uses `selectToolsToInstall()` with enum values and package names.
Future<void> selectKaliToolsPostExploitationToInstall() => selectToolsToInstall<KaliToolsPostExploitationEnum>(
  groupName: 'kali-tools-post-exploitation',
  values: KaliToolsPostExploitationEnum.values,
  packageNameGetter: (e) => e.package,
);
