import 'package:kali_on_debian/services/select_tools_to_install.dart';

/// Provides a predefined list of Kali exploitation-related tools and a selector to install them interactively.
///
/// The enum `KaliToolsExploitationEnum` defines supported packages.
enum KaliToolsExploitationEnum {
  armitage,
  beefXss,
  exploitdb,
  metasploitFramework,
  msfpc,
  set,
  shellnoob,
  sqlmap,
  termineter,
}

/// The map `_kaliToolsDatabaseMap` associates each enum with its corresponding package name.
Map<KaliToolsExploitationEnum, String> _kaliToolsDatabaseMap = {
  KaliToolsExploitationEnum.armitage: 'armitage',
  KaliToolsExploitationEnum.beefXss: 'beef-xss',
  KaliToolsExploitationEnum.exploitdb: 'exploitdb',
  KaliToolsExploitationEnum.metasploitFramework: 'metasploit-framework',
  KaliToolsExploitationEnum.msfpc: 'msfpc',
  KaliToolsExploitationEnum.set: 'set',
  KaliToolsExploitationEnum.shellnoob: 'shellnoob',
  KaliToolsExploitationEnum.sqlmap: 'sqlmap',
  KaliToolsExploitationEnum.termineter: 'termineter',
};

/// The extension `KaliToolsExploitationEnumExt` exposes the resolved package name via the package getter.
extension KaliToolsExploitationEnumExt on KaliToolsExploitationEnum {
  String get package {
    switch (this) {
      default:
        return _kaliToolsDatabaseMap[this]!;
    }
  }
}

/// Call `selectKaliToolsExploitationToInstall()` to prompt the user to select one or more tools to install from the `kali-tools-exploitation` group. Uses `selectToolsToInstall()` with enum values and package names.
Future<void> selectKaliToolsExploitationToInstall() =>
    selectToolsToInstall<KaliToolsExploitationEnum>(
      groupName: 'kali-tools-exploitation',
      values: KaliToolsExploitationEnum.values,
      packageNameGetter: (e) => e.package,
    );
